library(DESeq2)
colData <- read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/hyp_woman_info.csv",header = T, sep = ',')
colData$BUID <- as.factor(colData$BUID)
colData$subjectID <- as.factor(colData$subjectID)
colData$miRNA_batch <- as.factor(colData$miRNA_batch)
colData$cogdx <- as.factor(colData$cogdx)
colData$age_death <- as.factor(colData$age_death)
colData$msex <- as.factor(colData$msex)
colData$RIN <- as.factor(colData$RIN)
colData$sampleID <- as.factor(colData$sampleID)
colData$brain_region <- as.factor(colData$brain_region)
cts <- as.matrix(read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/hyp_woman_data.csv",header = T, sep=','))
ddsHTSeq <- DESeqDataSetFromMatrix(countData = cts, colData = colData, design = ~ RIN + age_death)
ddsHTSeq <- estimateSizeFactors(ddsHTSeq)
ddsHTSeq <- estimateDispersions(ddsHTSeq)
ddsHTSeq <- nbinomWaldTest(ddsHTSeq, maxit=5000)
ddsHTSeq <- nbinomWaldTest(ddsHTSeq, maxit=6000)
ddsHTSeq <- nbinomWaldTest(ddsHTSeq, maxit=10000)
write.csv(as.data.frame(counts(ddsHTSeq, normalize=T)), "woman_hyp_normalized_counts.csv")
library(DESeq2)
colData <- read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/hyp_man_info.csv",header = T, sep = ',')
colData$BUID <- as.factor(colData$BUID)
colData$subjectID <- as.factor(colData$subjectID)
colData$miRNA_batch <- as.factor(colData$miRNA_batch)
colData$cogdx <- as.factor(colData$cogdx)
colData$age_death <- as.factor(colData$age_death)
colData$msex <- as.factor(colData$msex)
colData$RIN <- as.factor(colData$RIN)
colData$sampleID <- as.factor(colData$sampleID)
colData$brain_region <- as.factor(colData$brain_region)
cts <- as.matrix(read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/hyp_man_data.csv",header = T, sep=','))
ddsHTSeq <- DESeqDataSetFromMatrix(countData = cts, colData = colData, design = ~ RIN + age_death)
ddsHTSeq <- estimateSizeFactors(ddsHTSeq)
ddsHTSeq <- estimateDispersions(ddsHTSeq)
ddsHTSeq <- nbinomWaldTest(ddsHTSeq, maxit=10000)
write.csv(as.data.frame(counts(ddsHTSeq, normalize=T)), "man_hyp_normalized_counts.csv")
library(DESeq2)
colData <- read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/hyp_woman_info.csv",header = T, sep = ',')
colData$BUID <- as.factor(colData$BUID)
colData$subjectID <- as.factor(colData$subjectID)
colData$miRNA_batch <- as.factor(colData$miRNA_batch)
colData$cogdx <- as.factor(colData$cogdx)
colData$age_death <- as.factor(colData$age_death)
colData$msex <- as.factor(colData$msex)
colData$RIN <- as.factor(colData$RIN)
colData$sampleID <- as.factor(colData$sampleID)
colData$brain_region <- as.factor(colData$brain_region)
cts <- as.matrix(read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/hyp_woman_data.csv",header = T, sep=','))
ddsHTSeq <- DESeqDataSetFromMatrix(countData = cts, colData = colData, design = ~ RIN + age_death)
ddsHTSeq <- estimateSizeFactors(ddsHTSeq)
ddsHTSeq <- estimateDispersions(ddsHTSeq)
ddsHTSeq <- nbinomWaldTest(ddsHTSeq, maxit=20000)
library(DESeq2)
colData <- read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/nuc_woman_info.csv",header = T, sep = ',')
colData$BUID <- as.factor(colData$BUID)
colData$subjectID <- as.factor(colData$subjectID)
colData$miRNA_batch <- as.factor(colData$miRNA_batch)
colData$cogdx <- as.factor(colData$cogdx)
colData$age_death <- as.factor(colData$age_death)
colData$msex <- as.factor(colData$msex)
colData$RIN <- as.factor(colData$RIN)
colData$sampleID <- as.factor(colData$sampleID)
colData$brain_region <- as.factor(colData$brain_region)
cts <- as.matrix(read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/nuc_woman_data.csv",header = T, sep=','))
ddsHTSeq <- DESeqDataSetFromMatrix(countData = cts, colData = colData, design = ~ RIN + age_death)
ddsHTSeq <- estimateSizeFactors(ddsHTSeq)
ddsHTSeq <- estimateDispersions(ddsHTSeq)
ddsHTSeq <- nbinomWaldTest(ddsHTSeq, maxit=10000)
ddsHTSeq <- estimateDispersions(ddsHTSeq)
ddsHTSeq <- nbinomWaldTest(ddsHTSeq, maxit=15000)
ddsHTSeq <- nbinomWaldTest(ddsHTSeq, maxit=10000)
write.csv(as.data.frame(counts(ddsHTSeq, normalize=T)), "woman_nuc_normalized_counts.csv")
library(DESeq2)
colData <- read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/nuc_man_info.csv",header = T, sep = ',')
colData$BUID <- as.factor(colData$BUID)
colData$subjectID <- as.factor(colData$subjectID)
colData$miRNA_batch <- as.factor(colData$miRNA_batch)
colData$cogdx <- as.factor(colData$cogdx)
colData$age_death <- as.factor(colData$age_death)
colData$msex <- as.factor(colData$msex)
colData$RIN <- as.factor(colData$RIN)
colData$sampleID <- as.factor(colData$sampleID)
colData$brain_region <- as.factor(colData$brain_region)
cts <- as.matrix(read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/nuc_man_data.csv",header = T, sep=','))
ddsHTSeq <- DESeqDataSetFromMatrix(countData = cts, colData = colData, design = ~ RIN + age_death)
ddsHTSeq <- estimateSizeFactors(ddsHTSeq)
ddsHTSeq <- estimateDispersions(ddsHTSeq)
ddsHTSeq <- nbinomWaldTest(ddsHTSeq, maxit=10000)
write.csv(as.data.frame(counts(ddsHTSeq, normalize=T)), "man_nuc_normalized_counts.csv")
library(DESeq2)
colData <- read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/nuc_man_info.csv",header = T, sep = ',')
colData$BUID <- as.factor(colData$BUID)
colData$subjectID <- as.factor(colData$subjectID)
colData$miRNA_batch <- as.factor(colData$miRNA_batch)
colData$cogdx <- as.factor(colData$cogdx)
colData$age_death <- as.factor(colData$age_death)
colData$msex <- as.factor(colData$msex)
colData$RIN <- as.factor(colData$RIN)
colData$sampleID <- as.factor(colData$sampleID)
colData$brain_region <- as.factor(colData$brain_region)
cts <- as.matrix(read.csv("C:/Users/Lab Members/PycharmProjects/research/miRNA/nuc_man_data.csv",header = T, sep=','))
ddsHTSeq <- DESeqDataSetFromMatrix(countData = cts, colData = colData, design = ~ RIN + age_death)
ddsTxi <- DESeq(ddsTxi)
ddsHTSeq <- DESeqDataSetFromMatrix(countData = cts, colData = colData, design = ~ RIN + age_death)
ddsHTSeq <- DESeq(ddsHTSeq)
ddsHTSeq <- tpm(ddsHTSeq)
res <- results(ddsHTSeq, name="condition_trt_vs_untrt")
res <- results(ddsHTSeq, name="condition_trt_vs_untrt.csv")
res <- results(ddsHTSeq, name="condition")
res <- results(ddsHTSeq, contrast="cogdx", alpha=0.05)
